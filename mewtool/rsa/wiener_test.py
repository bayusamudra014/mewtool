from mewtool.rsa.wiener import wiener_find_d, wiener_find_pq


def test_wiener():
    e = 42667
    n = 64741
    d = wiener_find_d(e, n)

    assert d == pow(e, -1, (641 - 1) * (101 - 1))


def test_wiener_find_prime():
    e = 42667
    n = 64741
    p, q = wiener_find_pq(e, n)

    assert p * q == n


def test_wiener_big():
    e = 4116464070077380333471551895331741696832850142359496532556992787304249808430302894217828141576583592408499083369091979056556243492142749560432134797189963314709764222319446175708417838340338937960153059576432377817254227678446119511826390861301940759366665119898141045279281618625440228209656731785849845934457557507643190816605346590572067902714119814079227069728957784606672099500612519526655208097198555773966702875594353862025611538199035535430516477958395769885535202292361010777054088036534454257909366710481706518208981636637058618564852881220064755583075190489805941652777042953664732089438805924773644980755
    n = 21099673234267271018201012927864435860452092828794949261344813284904769699950392682245120780159276424730084839540129765467544365301624811171333393191680050117906094061406577168194087222023736117284016756192762231380676616659831747700837218103233871834109791241700683009642003443207644201399860806468809534534735080335954071342416236012237523557257941584117822951336896018138994091354395725081838804516210747389517694144532029530320598228220734903364496757792278874429742502156525873749846000646829063152421305914356710898419020956792357284408837272596554823181856472343616488428881145256046393779581665608944309423481
    d = wiener_find_d(e, n)
    p, q = wiener_find_pq(e, n)

    assert d == 61339
    assert p * q == n
